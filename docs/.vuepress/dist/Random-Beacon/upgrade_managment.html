<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Upgrade management | Keep Network</title>
    <meta name="generator" content="VuePress 1.5.4">
    <link rel="icon" href="/K-fav.png">
    <meta name="description" content="">
    <link rel="preload" href="/assets/css/0.styles.f41374e8.css" as="style"><link rel="preload" href="/assets/js/app.ee7cc7e2.js" as="script"><link rel="preload" href="/assets/js/21.10f9f555.js" as="script"><link rel="preload" href="/assets/js/18.6681fcd2.js" as="script"><link rel="preload" href="/assets/js/34.9f447bc8.js" as="script"><link rel="preload" href="/assets/js/22.3632abb5.js" as="script"><link rel="preload" href="/assets/js/42.134b01e7.js" as="script"><link rel="preload" href="/assets/js/52.7d2d0d58.js" as="script"><link rel="preload" href="/assets/js/26.14abd936.js" as="script"><link rel="preload" href="/assets/js/7.33575ab8.js" as="script"><link rel="preload" href="/assets/js/4.bcb8a545.js" as="script"><link rel="preload" href="/assets/js/74.ee77b48f.js" as="script"><link rel="preload" href="/assets/js/2.9632a545.js" as="script"><link rel="preload" href="/assets/js/24.5850abf4.js" as="script"><link rel="preload" href="/assets/js/10.3c97637c.js" as="script"><link rel="preload" href="/assets/js/9.1a5079a2.js" as="script"><link rel="preload" href="/assets/js/13.985b168b.js" as="script"><link rel="preload" href="/assets/js/17.539c5154.js" as="script"><link rel="prefetch" href="/assets/js/11.1a5e5687.js"><link rel="prefetch" href="/assets/js/12.be9c1737.js"><link rel="prefetch" href="/assets/js/14.67549b21.js"><link rel="prefetch" href="/assets/js/15.76990a1b.js"><link rel="prefetch" href="/assets/js/16.aa0bc20d.js"><link rel="prefetch" href="/assets/js/19.a5500fe4.js"><link rel="prefetch" href="/assets/js/20.272461a1.js"><link rel="prefetch" href="/assets/js/23.18d3c5bd.js"><link rel="prefetch" href="/assets/js/25.be04c72f.js"><link rel="prefetch" href="/assets/js/27.3a593e9f.js"><link rel="prefetch" href="/assets/js/28.a5d09194.js"><link rel="prefetch" href="/assets/js/29.752a3887.js"><link rel="prefetch" href="/assets/js/3.3cf969a9.js"><link rel="prefetch" href="/assets/js/30.1ef6f2bd.js"><link rel="prefetch" href="/assets/js/31.7a484b6e.js"><link rel="prefetch" href="/assets/js/32.2a7b22c8.js"><link rel="prefetch" href="/assets/js/33.6cd743bf.js"><link rel="prefetch" href="/assets/js/35.2ec78fbe.js"><link rel="prefetch" href="/assets/js/36.fa6c65ef.js"><link rel="prefetch" href="/assets/js/37.ad5e894d.js"><link rel="prefetch" href="/assets/js/38.1ecbba7b.js"><link rel="prefetch" href="/assets/js/39.a79fe0e5.js"><link rel="prefetch" href="/assets/js/40.fae9a272.js"><link rel="prefetch" href="/assets/js/41.7e6c48be.js"><link rel="prefetch" href="/assets/js/43.e92ab542.js"><link rel="prefetch" href="/assets/js/44.ebefbbbb.js"><link rel="prefetch" href="/assets/js/45.dadf987e.js"><link rel="prefetch" href="/assets/js/46.8dc0c3fa.js"><link rel="prefetch" href="/assets/js/47.cf52a39e.js"><link rel="prefetch" href="/assets/js/48.1aea6f00.js"><link rel="prefetch" href="/assets/js/49.17bbeb6f.js"><link rel="prefetch" href="/assets/js/5.5ee10bf6.js"><link rel="prefetch" href="/assets/js/50.3a856145.js"><link rel="prefetch" href="/assets/js/51.e88f2628.js"><link rel="prefetch" href="/assets/js/53.9618f236.js"><link rel="prefetch" href="/assets/js/54.1d849037.js"><link rel="prefetch" href="/assets/js/55.fc0d5749.js"><link rel="prefetch" href="/assets/js/56.7abce0e0.js"><link rel="prefetch" href="/assets/js/57.7d146531.js"><link rel="prefetch" href="/assets/js/58.e83e7252.js"><link rel="prefetch" href="/assets/js/59.62be9969.js"><link rel="prefetch" href="/assets/js/6.9e30c3ae.js"><link rel="prefetch" href="/assets/js/60.8844909b.js"><link rel="prefetch" href="/assets/js/61.6edfd6c7.js"><link rel="prefetch" href="/assets/js/62.bc6a298b.js"><link rel="prefetch" href="/assets/js/63.b114efa9.js"><link rel="prefetch" href="/assets/js/64.1dae7019.js"><link rel="prefetch" href="/assets/js/65.b3162b30.js"><link rel="prefetch" href="/assets/js/66.72f11948.js"><link rel="prefetch" href="/assets/js/67.bebbbaee.js"><link rel="prefetch" href="/assets/js/68.39427fe4.js"><link rel="prefetch" href="/assets/js/69.410ee7f3.js"><link rel="prefetch" href="/assets/js/70.2c622f5c.js"><link rel="prefetch" href="/assets/js/71.4214fb2d.js"><link rel="prefetch" href="/assets/js/72.f7d49ed2.js"><link rel="prefetch" href="/assets/js/73.0c85f6b4.js"><link rel="prefetch" href="/assets/js/75.dab2e986.js"><link rel="prefetch" href="/assets/js/76.b0d76b80.js"><link rel="prefetch" href="/assets/js/77.31357bc5.js"><link rel="prefetch" href="/assets/js/78.b79a12dc.js"><link rel="prefetch" href="/assets/js/79.871ae359.js"><link rel="prefetch" href="/assets/js/8.9fd206a3.js"><link rel="prefetch" href="/assets/js/80.96f1e19a.js"><link rel="prefetch" href="/assets/js/81.646a0e30.js"><link rel="prefetch" href="/assets/js/82.b7bd3a17.js"><link rel="prefetch" href="/assets/js/83.c3871fcb.js"><link rel="prefetch" href="/assets/js/84.6ec38beb.js"><link rel="prefetch" href="/assets/js/85.235c1d04.js"><link rel="prefetch" href="/assets/js/86.1128aedf.js"><link rel="prefetch" href="/assets/js/87.f6563f66.js"><link rel="prefetch" href="/assets/js/88.f9d29126.js"><link rel="prefetch" href="/assets/js/89.328695a2.js"><link rel="prefetch" href="/assets/js/90.2f3d1f7e.js"><link rel="prefetch" href="/assets/js/91.95a24ec3.js"><link rel="prefetch" href="/assets/js/92.acc4f457.js"><link rel="prefetch" href="/assets/js/93.84d45ebe.js"><link rel="prefetch" href="/assets/js/94.12fe0542.js"><link rel="prefetch" href="/assets/js/95.d650c395.js">
    <link rel="stylesheet" href="/assets/css/0.styles.f41374e8.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div data-v-ef5e44d0><div data-v-40401285 data-v-ef5e44d0><div class="banner-wrapper" data-v-40401285 data-v-40401285><div class="wrapper" data-v-40401285><div class="message" data-v-40401285>By using this website, you agree to our <a href="https://www.cookiesandyou.com" target="_blank" rel="noopener" style="color:#505FFF;" data-v-40401285>Cookie Policy</a>.</div> <div class="box" data-v-40401285><span class="icon-cross" data-v-40401285><svg width="16" height="16" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-40401285><path d="M1.66669 1.66669L12.3334 12.3334M12.3334 1.66669L1.66664 12.3334" stroke="#A2A3AD" stroke-width="1.5" stroke-linecap="round" data-v-40401285></path></svg></span></div></div></div></div><div data-v-4dbc101d data-v-ef5e44d0><!----></div><div class="layout" data-v-ef5e44d0><div class="layout__sidebar" data-v-ef5e44d0><div style="height:100%;position:relative;" data-v-34b64b62 data-v-ef5e44d0><div class="container" data-v-34b64b62><a href="/" class="logo__container router-link-active" data-v-34b64b62><div class="logo" data-v-34b64b62><div class="logo__img" data-v-34b64b62><svg width="100%" height="100%" viewBox="0 0 160 160" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-34b64b62><path fill-rule="evenodd" clip-rule="evenodd" d="M75 6C113 6 144 37 144 75C144 113 113 144 75 144C37 144 6 113 6 75C6 37 37 6 75 6ZM75 0C33.6 0 0 33.6 0 75C0 116.4 33.6 150 75 150C116.4 150 150 116.4 150 75C150 33.6 116.4 0 75 0ZM106.5 58.3H101.8L87.4 75L101.7 91.7H106.4V105.1H76.1V91.9H80.8L71.4 81H67.5V91.9H72.8V105.2H43.5V91.7H49.9V75V58.3H43.5V44.8H50.7V49.8H54.6V44.8H61.7V49.8H65.6V44.8H72.8V58.1H67.5V69H71.4L80.8 58.1H76.1V44.8H106.5V58.3Z" fill="#48DBB4"></path></svg></div><div class="logo__text" data-v-34b64b62>Keep Network</div></div></a><div class="items footer__compact__false" data-v-34b64b62><div class="sidebar" style="display:none;" data-v-34b64b62><div class="title" data-v-34b64b62></div><!----></div><div class="sidebar" style="display:block;" data-v-34b64b62><div class="title" data-v-34b64b62>Documentation</div><!----></div><div class="sidebar" style="display:block;" data-v-34b64b62><div class="title" data-v-34b64b62>Additional info</div><!----></div><div class="sidebar" style="display:block;" data-v-34b64b62><div class="title" data-v-34b64b62>Resources</div><!----></div></div><!----></div></div></div><div class="layout__main" data-v-ef5e44d0><div class="layout__main__navbar" data-v-ef5e44d0><div data-v-91cd73f2 data-v-ef5e44d0><div class="container" data-v-91cd73f2><div class="menu" data-v-91cd73f2><div class="menu__icon" data-v-91cd73f2><svg width="100%" height="100%" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" stroke="#888" data-v-91cd73f2><path d="M2 5H22M2 12H22M2 19H22" stroke-width="1.5" stroke-linecap="round"></path></svg></div></div><div class="logo" data-v-91cd73f2><div class="logo__wrapper router-link-active" data-v-91cd73f2><div class="logo__image" data-v-91cd73f2><svg width="100%" height="100%" viewBox="0 0 160 160" xmlns="http://www.w3.org/2000/svg" data-v-91cd73f2><path fill-rule="evenodd" clip-rule="evenodd" d="M75 6C113 6 144 37 144 75C144 113 113 144 75 144C37 144 6 113 6 75C6 37 37 6 75 6ZM75 0C33.6 0 0 33.6 0 75C0 116.4 33.6 150 75 150C116.4 150 150 116.4 150 75C150 33.6 116.4 0 75 0ZM106.5 58.3H101.8L87.4 75L101.7 91.7H106.4V105.1H76.1V91.9H80.8L71.4 81H67.5V91.9H72.8V105.2H43.5V91.7H49.9V75V58.3H43.5V44.8H50.7V49.8H54.6V44.8H61.7V49.8H65.6V44.8H72.8V58.1H67.5V69H71.4L80.8 58.1H76.1V44.8H106.5V58.3Z"></path></svg></div><div class="logo__text" data-v-91cd73f2>Keep Network</div></div></div><div class="toolbar" data-v-91cd73f2><div class="toolbar__item" data-v-91cd73f2><div class="toolbar__item__icon" data-v-91cd73f2><svg width="100%" height="100%" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" fill="#888" data-v-91cd73f2><path fill-rule="evenodd" clip-rule="evenodd" d="M11.5 2.75C6.66751 2.75 2.75 6.66751 2.75 11.5C2.75 16.3325 6.66751 20.25 11.5 20.25C13.6462 20.25 15.612 19.4773 17.1342 18.1949L22.6697 23.7303C22.9626 24.0232 23.4374 24.0232 23.7303 23.7303C24.0232 23.4374 24.0232 22.9626 23.7303 22.6697L18.1949 17.1342C19.4773 15.612 20.25 13.6462 20.25 11.5C20.25 6.66751 16.3325 2.75 11.5 2.75ZM16.6923 16.5599C17.9656 15.2535 18.75 13.4684 18.75 11.5C18.75 7.49594 15.5041 4.25 11.5 4.25C7.49594 4.25 4.25 7.49594 4.25 11.5C4.25 15.5041 7.49594 18.75 11.5 18.75C13.4684 18.75 15.2535 17.9656 16.5599 16.6923C16.5789 16.6679 16.5996 16.6444 16.622 16.622C16.6444 16.5996 16.6679 16.5789 16.6923 16.5599Z"></path></svg></div></div></div></div></div></div><div class="layout__main__content aside__true" data-v-ef5e44d0><div id="content-scroll" class="layout__main__content__body" data-v-ef5e44d0><div class="layout__main__content__body__breadcrumbs" data-v-ef5e44d0><div data-v-4fd33f92 data-v-ef5e44d0><div class="container" data-v-4fd33f92><div class="crumbs" data-v-4fd33f92><a href="/" class="crumbs__item router-link-active" data-v-4fd33f92>Keep Network</a><a href="/Random-Beacon/upgrade_managment.html" aria-current="page" class="crumbs__item router-link-exact-active router-link-active" data-v-4fd33f92>Random-Beacon</a><a href="/Random-Beacon/upgrade_managment.html" aria-current="page" class="crumbs__item router-link-exact-active router-link-active" data-v-4fd33f92>Upgrade management</a></div><div class="menu" data-v-4fd33f92><div class="menu__item" style="visibility:visible;" data-v-4fd33f92><svg width="100%" height="100%" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="menu__item__icon menu__item__icon__active__false" data-v-4fd33f92><path fill-rule="evenodd" clip-rule="evenodd" d="M0.25 2C0.25 1.58579 0.585786 1.25 1 1.25H6C6.41421 1.25 6.75 1.58579 6.75 2C6.75 2.41421 6.41421 2.75 6 2.75H1C0.585786 2.75 0.25 2.41421 0.25 2ZM17.53 22.7803L16.9997 22.25L17.53 22.7803L17.5301 22.7802L17.5305 22.7798L17.5322 22.7781L17.5388 22.7715L17.5647 22.7456L17.6647 22.6456L18.0367 22.2737L19.2978 21.0126L22.53 17.7803C22.8229 17.4874 22.8229 17.0126 22.53 16.7197C22.2371 16.4268 21.7622 16.4268 21.4693 16.7197L18.2371 19.9519L17.7497 20.4393V8.5C17.7497 6.34186 17.0721 4.51182 15.7802 3.21983C14.4882 1.92783 12.6581 1.25031 10.5 1.25031C10.0858 1.25031 9.75 1.5861 9.75 2.00031C9.75 2.41453 10.0858 2.75031 10.5 2.75031C12.3419 2.75031 13.7617 3.32264 14.7195 4.28049C15.6773 5.23834 16.2497 6.65814 16.2497 8.5L16.2497 20.4393L12.53 16.7197C12.2371 16.4268 11.7622 16.4268 11.4693 16.7197C11.1764 17.0126 11.1764 17.4874 11.4693 17.7803L16.4693 22.7803L16.9997 23.3107L17.53 22.7803ZM1 6.25C0.585786 6.25 0.25 6.58579 0.25 7C0.25 7.41421 0.585786 7.75 1 7.75H10C10.4142 7.75 10.75 7.41421 10.75 7C10.75 6.58579 10.4142 6.25 10 6.25H1ZM0.25 12C0.25 11.5858 0.585786 11.25 1 11.25H12C12.4142 11.25 12.75 11.5858 12.75 12C12.75 12.4142 12.4142 12.75 12 12.75H1C0.585786 12.75 0.25 12.4142 0.25 12ZM1 16.25C0.585786 16.25 0.25 16.5858 0.25 17C0.25 17.4142 0.585786 17.75 1 17.75H8C8.41421 17.75 8.75 17.4142 8.75 17C8.75 16.5858 8.41421 16.25 8 16.25H1Z" data-v-4fd33f92></path></svg><!----></div></div></div></div></div><div class="layout__main__content__body__wrapper" data-v-ef5e44d0><div style="width:100%;" data-v-479b6da3 data-v-ef5e44d0><div class="search__container" data-v-479b6da3><div class="search" data-v-479b6da3><div class="search__icon" data-v-479b6da3><svg width="100%" height="100%" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" data-v-479b6da3><path fill-rule="evenodd" clip-rule="evenodd" d="M11.5 2.75C6.66751 2.75 2.75 6.66751 2.75 11.5C2.75 16.3325 6.66751 20.25 11.5 20.25C13.6462 20.25 15.612 19.4773 17.1342 18.1949L22.6697 23.7303C22.9626 24.0232 23.4374 24.0232 23.7303 23.7303C24.0232 23.4374 24.0232 22.9626 23.7303 22.6697L18.1949 17.1342C19.4773 15.612 20.25 13.6462 20.25 11.5C20.25 6.66751 16.3325 2.75 11.5 2.75ZM16.6923 16.5599C17.9656 15.2535 18.75 13.4684 18.75 11.5C18.75 7.49594 15.5041 4.25 11.5 4.25C7.49594 4.25 4.25 7.49594 4.25 11.5C4.25 15.5041 7.49594 18.75 11.5 18.75C13.4684 18.75 15.2535 17.9656 16.5599 16.6923C16.5789 16.6679 16.5996 16.6444 16.622 16.622C16.6444 16.5996 16.6679 16.5789 16.6923 16.5599Z"></path></svg></div><div class="search__text" data-v-479b6da3>Search</div></div></div><div class="container" data-v-479b6da3><div class="content__default" data-v-ef5e44d0><h1 id="upgrade-management"><a href="#upgrade-management" class="header-anchor">#</a> Upgrade management</h1> <p>The system has been designed to facilitate upgrades without exposing stakers to vulnerabilities commonly found in upgradeable smart contracts. For this purpose, smart contracts in the system are divided into different categories based on their purpose and functionality, and strict security boundaries are maintained in the design.</p> <p>Furthermore, the authority to take various actions in the system has been divided into a number of roles where each role has a specific purpose and domain. The roles and their authorizations are designed to limit the impact of single key compromise. Severely harmful actions such as stealing participants' stakes should require the compromise of multiple independent actors wherever feasible.</p> <h2 id="contract-structure"><a href="#contract-structure" class="header-anchor">#</a> Contract structure</h2> <h3 id="overview"><a href="#overview" class="header-anchor">#</a> Overview</h3> <hr> <p><strong>Token contract</strong></p> <p>KEEP is an ERC20 token defined by the <em>token contract</em>. The token contract is hard-coded in the operator and staking contracts, but the design of the overall system makes it possible to later migrate to a new version of the token contract without disrupting customer experience.</p> <p><strong>Staking contract</strong></p> <p>Owners of KEEP tokens can use a <em>staking contract</em> to <em>stake</em> them and use them as collateral for <em>operators</em> who perform useful work in the Keep Network. Staked tokens are transferred to the staking contract and <em>delegated</em> to an operator address. The staking contract makes the tokens available to <em>operator contracts</em> that have been <em>authorized</em> to punish the operator in case of misbehavior, while protecting them from unauthorized operator contracts.</p> <p><strong>Operator contracts</strong></p> <p>Operators interact with <em>operator contracts</em> to perform useful work for customers. Operator contracts handle operations that are critical for the proper incentives of individual operators. They reward operators for correct behavior, and are authorized to punish misbehavior.</p> <p><strong>Service contracts</strong></p> <p><em>Service contracts</em> provide higher-level services to the public using work performed by one or more operator contracts. Service contracts do not interact directly with operators nor do they need to be aware of the KEEP tokens or the staking contract. Operator contracts can be upgraded without disrupting customer experience by deploying a new version and adding it to the service contract.</p> <p><strong>Registry</strong></p> <p>The addresses of contracts approved by Keep Org are kept in the <em>registry</em>. Token contracts, staking contracts, operator contracts and service contracts are all tracked separately in the registry. The addresses and statuses of various contracts can be queried from the registry.</p> <hr> <h3 id="operator-contracts"><a href="#operator-contracts" class="header-anchor">#</a> Operator contracts</h3> <p>Operator contracts coordinate the work performed by network operators, and provide services to other &quot;customer&quot; contracts. Operator contracts handle all operations that may have an impact on staked tokens. Conversely, operators performing work for the network only need to interact with operator contracts.</p> <p>The customer contract is treated as untrusted and the operator contract must maintain correctness and the safety of the operators' stakes regardless of the customer contract’s input. Each operator contract is an independent &quot;microservice&quot;, keeping its own state on security-critical data.</p> <p>When a customer contract requests an operator contract to perform a service, it must pay the operator contract for the service provided. The payment is distributed to contributing operators according to the operator contract’s own rules. An operator contract can either provide services to any contract that makes a valid request and pays the correct fee, or it can be owned by a specific contract and only serve its owner. In the random beacon the service contract is the only &quot;customer&quot; of the operator contracts, and operator contracts only provide services to the random beacon. Future operator contracts may provide services directly to the public.</p> <p>If one or more participant operators misbehave or fail to perform promised work, the operator contract tells the staking contract to punish the guilty parties and optionally reward a tattletale that proved the misbehavior. To punish misbehaving operators, an operator contract must be authorized by the operator’s authorizer. Once an operator contract has been authorized by some address, it can never be deauthorized by that address.</p> <h3 id="service-contracts"><a href="#service-contracts" class="header-anchor">#</a> Service contracts</h3> <p>Service contracts use the basic functionality performed by operator contracts, to provide useful services to the public. In contrast to operator contracts, service contracts don’t interact directly with operators and a failure in a service contract cannot risk operators' stakes.</p> <p>Service contracts receive requests for their services from customers, and provide the requested services. Elements that are critical for operators' security and incentives are delegated to an operator contract, while other parts of the work are performed in the service contract. The service contract keeps shared state which is not security-critical.</p> <p>Service contracts can use multiple different versions of operator contracts to perform the operator contract functions. To permit system upgrades, the list of used operator contracts can be updated with proper authorization.</p> <h2 id="roles-and-authorizations"><a href="#roles-and-authorizations" class="header-anchor">#</a> Roles and authorizations</h2> <h3 id="roles"><a href="#roles" class="header-anchor">#</a> Roles</h3> <hr> <p><strong>Governance</strong></p> <p>Governance is the final arbiter of authority in the Keep Network. The role of Governance is to enable recovery from key compromise by rekeying other roles. Governance has the authority to change the addresses of the <em>Registry Keeper</em>, <em>Panic Button</em>, and the service contracts' <em>Operator Contract Upgraders</em>. The rekeying process is currently unspecified.</p> <p><strong>Registry Keeper</strong></p> <p>The Registry Keeper maintains the global <em>registry</em> of approved contracts. Each operator contract must be approved by the Registry Keeper before it can be authorized to punish operators or used by a service contract. The Registry Keeper can be rekeyed by <em>Governance</em>.</p> <p><strong>Panic Button</strong></p> <p>The Panic Button can disable malicious or malfunctioning contracts that have been previously approved by the Registry Keeper. When a contract is disabled by the Panic Button, its status on the <em>registry</em> changes to reflect this, and it becomes ineligible to penalize operators. Contracts disabled by the Panic Button can not be reactivated. The Panic Button can be rekeyed by <em>Governance</em>.</p> <p><strong>Operator Contract Upgrader</strong></p> <p>Each service contract has an Operator Contract Upgrader whose purpose is to manage operator contracts for that service contract. The Operator Contract Upgrader can add new operator contracts to the service contract, and deprecate old ones. The Operator Contract Upgraders can be rekeyed by <em>Governance</em>.</p> <p><strong>Authorizer</strong></p> <p>Each operator has an Authorizer whose purpose is to determine which operator contracts may punish the operator for misbehavior. The operator can only perform work for authorized operator contracts. The Authorizer cannot be rekeyed except by undelegating and redelegating.</p> <hr> <h3 id="authorizations"><a href="#authorizations" class="header-anchor">#</a> Authorizations</h3> <h4 id="the-registry-and-panic-button"><a href="#the-registry-and-panic-button" class="header-anchor">#</a> The Registry and Panic Button</h4> <p>The registry tracks all Keep Org -approved contracts. Operator contracts have a special status on the registry, reflecting the ability of the Panic Button to disable them.</p> <p>Each operator contract’s status may be <code>NULL</code>, <code>APPROVED</code> or <code>DISABLED</code>.</p> <p>A status of <code>NULL</code> is the default and means that the operator contract has not been approved by the <em>Registry Keeper</em>.</p> <p>When the <em>Registry Keeper</em> approves a operator contract, its status switches to <code>APPROVED</code> in the registry. Approved operator contracts can be authorized to punish operators, and service contracts may utilize them.</p> <p>The <em>Panic Button</em> can be used to set the status of an <code>APPROVED</code> contract to <code>DISABLED</code>. Operator Contracts disabled with the <em>Panic Button</em> cannot be re-enabled, and disabled contracts may not punish operators nor be selected by service contracts to perform work.</p> <h4 id="staking-contracts-authorized-operator-contracts"><a href="#staking-contracts-authorized-operator-contracts" class="header-anchor">#</a> Staking contracts: authorized operator contracts</h4> <p>Staking contracts hold staked tokens, enforce staking rules, and punish misbehaving operators on behalf of authorized operator contracts. For this purpose, each staking contract tracks which operator contracts have been authorized by which addresses.</p> <p>The status of a contract may be either <code>NULL</code> or <code>AUTHORIZED</code>. A status of <code>NULL</code> is the default and means the operator contract is not authorized. A status of <code>AUTHORIZED</code> means that the operator contract may impose punishments on those operators who have assigned that <code>authorizer</code> as their <em>Authorizer</em>.</p> <p>To authorize an operator contract on a staking contract, the operator contract must have been <code>APPROVED</code> on the <em>registry</em>. Once a operator contract has been authorized, authorization cannot be withdrawn by the authorizer. However, a operator contract that has been <code>DISABLED</code> by the <em>Panic Button</em> may not punish stakers.</p> <h4 id="service-contracts-used-operator-contracts"><a href="#service-contracts-used-operator-contracts" class="header-anchor">#</a> Service contracts: used operator contracts</h4> <p>Service contracts use the basic functionality performed by operator contracts, to provide useful services to the public. Service contracts can use multiple different versions of operator contracts to perform the operator contract functions. To permit system upgrades, the list of used operator contracts can be updated with proper authorization.</p> <p>A service contract is deployed with zero operator contracts, rendering the service contract inactive until at least one operator contract is activated.</p> <p>Each service contract has its own <em>Operator Contract Upgrader</em> who can add used operator contracts. To add a used operator contract, the operator contract must have been <code>APPROVED</code> on the <em>registry</em>, and the interface it claims to implement must match what the service contract expects.</p> <p>If an operator contract has been <code>DISABLED</code> by the <em>Panic Button</em>, the service contract must not use its functionality. This must be checked when the service contract selects an operator contract.</p> <h2 id="upgrade-processes"><a href="#upgrade-processes" class="header-anchor">#</a> Upgrade processes</h2> <h3 id="operator-contract-upgrade"><a href="#operator-contract-upgrade" class="header-anchor">#</a> Operator contract upgrade</h3> <p>Operator contracts are immutable, and are upgraded by deploying a new version in a separate contract. The <em>Registry Keeper</em> then approves the new contract on the <em>registry</em>, and operators are able to authorize it. Once authorized by a sufficient number of stakers, the contract can be added into the used operator contracts of a service contract.</p> <p>Operator contracts can be upgraded without losing service contract state, but critical state is held within the operator contract and cannot be migrated.</p> <ol><li><p>Deploy the new operator contract</p></li> <li><p>Approve the operator contract on the registry</p></li> <li><p>Wait for stakers to authorize the operator contract</p></li> <li><p>Activate the operator contract on the relevant service contracts</p></li></ol> <h3 id="service-contract-upgrade"><a href="#service-contract-upgrade" class="header-anchor">#</a> Service contract upgrade</h3> <p>Because service contracts don’t impact the security of staked tokens, they can be upgraded in-place without migrating to a new address.</p> <h3 id="new-service-contract"><a href="#new-service-contract" class="header-anchor">#</a> New service contract</h3> <p>A new service contract is deployed on-chain and listed on the <em>registry</em>.</p> <p>If the service contract doesn’t rely on an operator contract exclusive to itself, it can be deployed after the operator contracts it uses are in place.</p> <p>Otherwise the service contract must be deployed first, inactive because it has no operator contracts it uses. Once the address of the service contract is determined, the operator contract is deployed, approved on the registry, and authorized by stakers. The operator contract can now be activated on the service contract, making it ready to provide services.</p> <ol><li><p>Deploy the new service contract</p></li> <li><p>Deploy a new operator contract serving the new service contract</p></li> <li><p>Approve the operator contract on the registry</p></li> <li><p>Wait for stakers to authorize the operator contract</p></li> <li><p>Activate the operator contract on the service contract</p></li></ol> <h3 id="staking-contract-upgrades"><a href="#staking-contract-upgrades" class="header-anchor">#</a> Staking contract upgrades</h3> <p>Staking contracts can be upgraded by deploying a new version, and waiting for stakers to migrate by withdrawing their stakes on the old contract and staking them again on the new contract. While stakers are migrating, new operator contracts using the new staking contract should be deployed. Once stakers have migrated and approved the new operator contracts, the contracts can be activated on service contracts.</p> <ol><li><p>Deploy the new staking contract</p></li> <li><p>Deploy new operator contracts recognizing the new staking contract</p></li> <li><p>Approve the operator contracts on the registry</p></li> <li><p>Wait for stakers to migrate to the new staking contract</p></li> <li><p>Wait for stakers to authorize the new operator contracts</p></li> <li><p>Activate the operator contracts on the service contracts</p></li></ol> <h3 id="token-upgrade"><a href="#token-upgrade" class="header-anchor">#</a> Token upgrade</h3> <p>The upgrade process makes it possible to even hard-fork the token without disrupting service contract user experience:</p> <ol><li><p>Deploy the new token contract</p></li> <li><p>Deploy a migration contract that lets holders convert old tokens to new tokens</p></li> <li><p>Deploy a new staking contract for the new tokens</p></li> <li><p>Deploy new operator contracts recognizing the new token and staking contract</p></li> <li><p>Approve the operator contracts on the registry</p></li> <li><p>Wait for stakers to convert their tokens, stake on the new contract and authorize the new operator contracts</p></li> <li><p>Activate the operator contracts on the service contracts</p></li></ol></div><!----></div></div></div></div><div class="layout__main__content__aside__container" style="--height-banners:nullpx;" data-v-ef5e44d0><div class="layout__main__content__aside aside__bottom__false" data-v-ef5e44d0><!----></div><div class="layout__main__content__aside__banners" data-v-ef5e44d0><a href="https://github.com/gnran/keep-docs/edit/master/docs/Keep-Network/intro.md" target="_blank" data-v-ef5e44d0><div data-v-5082805d data-v-ef5e44d0><div class="container" data-v-5082805d><svg width="100%" height="100%" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg" class="icon" data-v-5082805d><path d="M0.836491 13.7697C0.543598 14.0626 0.543598 14.5374 0.836492 14.8303C1.12939 15.1232 1.60426 15.1232 1.89715 14.8303L0.836491 13.7697ZM14.7729 1.95457C15.0658 1.66168 15.0658 1.1868 14.7729 0.893912C14.48 0.601019 14.0051 0.601019 13.7122 0.893913L14.7729 1.95457ZM14.6668 1H15.4168V0.25H14.6668V1ZM4.48498 0.25C4.07077 0.25 3.73498 0.585786 3.73498 1C3.73498 1.41421 4.07077 1.75 4.48498 1.75V0.25ZM13.9168 11.1818C13.9168 11.596 14.2526 11.9318 14.6668 11.9318C15.081 11.9318 15.4168 11.596 15.4168 11.1818H13.9168ZM1.89715 14.8303L14.7729 1.95457L13.7122 0.893913L0.836491 13.7697L1.89715 14.8303ZM14.6668 0.25H4.48498V1.75H14.6668V0.25ZM15.4168 11.1818V1H13.9168V11.1818H15.4168Z"></path></svg><div class="image" data-v-5082805d><svg width="41" height="44" viewBox="0 0 41 44" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-5082805d><path fill-rule="evenodd" clip-rule="evenodd" d="M4 1.8999H32C33.3807 1.8999 34.5 3.01919 34.5 4.3999V10.997L36 9.497V4.3999C36 2.19076 34.2091 0.399902 32 0.399902H4C1.79086 0.399902 0 2.19077 0 4.39991V39.5999C0 41.809 1.79086 43.5999 4 43.5999H32C34.2091 43.5999 36 41.809 36 39.5999V20.2096L34.5 21.7096V39.5999C34.5 40.9806 33.3807 42.0999 32 42.0999H4C2.61929 42.0999 1.5 40.9806 1.5 39.5999V4.39991C1.5 3.01919 2.61929 1.8999 4 1.8999ZM7.2 19.1999H26.2971L24.2971 21.1999H7.2V19.1999ZM7.2 15.7999H28.8V13.7999H7.2V15.7999ZM7.2 26.5999H16.2V24.5999H7.2V26.5999ZM20.8638 25.7372L20.7386 25.8624L20.6826 26.0303L18.9855 31.1215L18.4792 32.6406L19.9704 32.0571L24.8494 30.1479L24.9955 30.0908L25.1064 29.9798L37.9799 17.1063L39.7831 15.3032C40.9546 14.1316 40.9546 12.2321 39.7831 11.0606C38.6115 9.88898 36.712 9.88898 35.5404 11.0606L20.8638 25.7372ZM20.9149 30.0767L22.0496 26.6726L36.6011 12.1212C37.1869 11.5354 38.1366 11.5354 38.7224 12.1212C39.3082 12.707 39.3082 13.6567 38.7224 14.2425L37.4496 15.5153L36.2465 14.3122C35.9536 14.0193 35.4787 14.0193 35.1858 14.3122C34.8929 14.6051 34.8929 15.08 35.1858 15.3729L36.3889 16.576L24.5761 28.3888L23.6215 27.4342C23.3286 27.1413 22.8537 27.1413 22.5608 27.4342C22.2679 27.7271 22.2679 28.202 22.5608 28.4949L23.2349 29.1689L20.9149 30.0767Z" fill="var(--color-primary, blue)" data-v-5082805d></path></svg></div><div class="h1" data-v-5082805d>Found an Issue?</div><div class="h2" data-v-5082805d>Help us improve this page by suggesting edits on GitHub.</div></div></div></a></div></div></div><div class="layout__main__gutter" data-v-ef5e44d0><div data-v-6bb78c25 data-v-ef5e44d0><div class="links" data-v-6bb78c25><div class="links__wrapper" data-v-6bb78c25><div class="links__container" data-v-6bb78c25><a href="/Random-Beacon/missbehavior_and_punishment.html" class="links__item links__item__left" data-v-6bb78c25><div class="links__item__icon" data-v-6bb78c25><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 64 64" data-v-6bb78c25><title data-v-6bb78c25>arrow-right</title><g stroke-linecap="square" stroke-linejoin="miter" stroke-width="2" data-v-6bb78c25><line fill="none" stroke-miterlimit="10" x1="61" y1="32" x2="3" y2="32" stroke-linecap="butt" data-v-6bb78c25></line><polyline fill="none" stroke-miterlimit="10" points="21,14 3,32 21,50 " data-v-6bb78c25></polyline></g></svg></div><div data-v-6bb78c25><div class="links__label" data-v-6bb78c25>Previous</div><div class="links__item__title" data-v-6bb78c25>Misbehavior and punishments</div><!----></div></a></div></div><div class="links__wrapper" data-v-6bb78c25><div class="links__container" data-v-6bb78c25><a href="/Staking/intro.html" class="links__item links__item__right" data-v-6bb78c25><div data-v-6bb78c25><div class="links__label" data-v-6bb78c25>Next</div><div class="links__item__title" data-v-6bb78c25>Introduction</div><!----></div><div class="links__item__icon" data-v-6bb78c25><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 64 64" data-v-6bb78c25><title data-v-6bb78c25>arrow-right</title><g stroke-linecap="square" stroke-linejoin="miter" stroke-width="2" data-v-6bb78c25><line fill="none" stroke-miterlimit="10" x1="3" y1="32" x2="61" y2="32" stroke-linecap="butt" data-v-6bb78c25></line><polyline fill="none" stroke-miterlimit="10" points="43,14 61,32 43,50 " data-v-6bb78c25></polyline></g></svg></div></a></div></div></div></div></div><div class="layout__main__footer" data-v-ef5e44d0><div data-v-a564f786 data-v-ef5e44d0><div class="wrapper" data-v-a564f786><div class="container" data-v-a564f786><div class="footer__wrapper" data-v-a564f786><div class="questions" data-v-a564f786><div class="questions__wrapper" data-v-a564f786><div class="questions__h1" data-v-a564f786>Questions?</div><div class="questions__p" data-v-a564f786><div>Chat with Keep Network developers in <a href='https://discordapp.com/invite/wYezN7v' target='_blank'>Discord</a> or read the <a href='https://blog.keep.network/' target='_blank'>Keep Blog</a> to learn more.</div></div></div><form action="" data-code="u7o3l7" method="POST" target="_blank" rel="noreferrer noopener" class="newsletter__form__component__internal" data-v-7a2398aa data-v-a564f786><div class="newsletter__desc" data-v-7a2398aa><div class="newsletter__desc__h1" data-v-7a2398aa><label for="newsletter-email-input" data-v-7a2398aa>Get Keep Network updates</label></div><div class="newsletter__desc__p" data-v-7a2398aa>You’ll be notified with Keep updates, news and announcements.</div></div><div class="newsletter__input" data-v-7a2398aa><div class="newsletter__input__input" data-v-7a2398aa><input type="email" required="required" name="fields[email]" id="newsletter-email-input" placeholder="Your email" class="newsletter__input__input__el" data-v-7a2398aa><button type="submit" class="newsletter__input__input__button" data-v-7a2398aa>Sign up</button><input type="hidden" name="ml-submit" value="1" data-v-7a2398aa></div><div class="newsletter__input__p" data-v-7a2398aa>You can unsubscribe at any time.</div></div></form></div><!----><div class="logo" data-v-a564f786><div class="logo__item" data-v-a564f786><a href="https://keep.network/" target="_blank" rel="noreferrer noopener" tag="div" class="logo__image" data-v-a564f786><img src="/Keep_logo_mint.png" data-v-a564f786></a></div><div class="logo__item logo__link" data-v-a564f786><a href="https://blog.keep.network/" target="_blank" title="medium" rel="noreferrer noopener" class="smallprint__item__links__item" data-v-a564f786><svg width="24" height="24" xmlns="http://www.w3.org/2000/svg" fill-rule="evenodd" clip-rule="evenodd" fill="#aaa" data-v-a564f786><path d="M24 24h-24v-24h24v24zm-4.03-5.649v-.269l-1.247-1.224c-.11-.084-.165-.222-.142-.359v-8.998c-.023-.137.032-.275.142-.359l1.277-1.224v-.269h-4.422l-3.152 7.863-3.586-7.863h-4.638v.269l1.494 1.799c.146.133.221.327.201.523v7.072c.044.255-.037.516-.216.702l-1.681 2.038v.269h4.766v-.269l-1.681-2.038c-.181-.186-.266-.445-.232-.702v-6.116l4.183 9.125h.486l3.593-9.125v7.273c0 .194 0 .232-.127.359l-1.292 1.254v.269h6.274z" data-v-a564f786></path></svg></a><a href="https://twitter.com/keep_project" target="_blank" title="twitter" rel="noreferrer noopener" class="smallprint__item__links__item" data-v-a564f786><svg width="24" height="24" xmlns="http://www.w3.org/2000/svg" fill-rule="evenodd" clip-rule="evenodd" fill="#aaa" data-v-a564f786><path d="M24 4.557c-.883.392-1.832.656-2.828.775 1.017-.609 1.798-1.574 2.165-2.724-.951.564-2.005.974-3.127 1.195-.897-.957-2.178-1.555-3.594-1.555-3.179 0-5.515 2.966-4.797 6.045-4.091-.205-7.719-2.165-10.148-5.144-1.29 2.213-.669 5.108 1.523 6.574-.806-.026-1.566-.247-2.229-.616-.054 2.281 1.581 4.415 3.949 4.89-.693.188-1.452.232-2.224.084.626 1.956 2.444 3.379 4.6 3.419-2.07 1.623-4.678 2.348-7.29 2.04 2.179 1.397 4.768 2.212 7.548 2.212 9.142 0 14.307-7.721 13.995-14.646.962-.695 1.797-1.562 2.457-2.549z" data-v-a564f786></path></svg></a><a href="https://www.reddit.com/r/KeepNetwork/" target="_blank" title="reddit" rel="noreferrer noopener" class="smallprint__item__links__item" data-v-a564f786><svg width="24" height="24" xmlns="http://www.w3.org/2000/svg" fill-rule="evenodd" clip-rule="evenodd" fill="#aaa" data-v-a564f786><path d="M14.238 15.348c.085.084.085.221 0 .306-.465.462-1.194.687-2.231.687l-.008-.002-.008.002c-1.036 0-1.766-.225-2.231-.688-.085-.084-.085-.221 0-.305.084-.084.222-.084.307 0 .379.377 1.008.561 1.924.561l.008.002.008-.002c.915 0 1.544-.184 1.924-.561.085-.084.223-.084.307 0zm-3.44-2.418c0-.507-.414-.919-.922-.919-.509 0-.923.412-.923.919 0 .506.414.918.923.918.508.001.922-.411.922-.918zm13.202-.93c0 6.627-5.373 12-12 12s-12-5.373-12-12 5.373-12 12-12 12 5.373 12 12zm-5-.129c0-.851-.695-1.543-1.55-1.543-.417 0-.795.167-1.074.435-1.056-.695-2.485-1.137-4.066-1.194l.865-2.724 2.343.549-.003.034c0 .696.569 1.262 1.268 1.262.699 0 1.267-.566 1.267-1.262s-.568-1.262-1.267-1.262c-.537 0-.994.335-1.179.804l-2.525-.592c-.11-.027-.223.037-.257.145l-.965 3.038c-1.656.02-3.155.466-4.258 1.181-.277-.255-.644-.415-1.05-.415-.854.001-1.549.693-1.549 1.544 0 .566.311 1.056.768 1.325-.03.164-.05.331-.05.5 0 2.281 2.805 4.137 6.253 4.137s6.253-1.856 6.253-4.137c0-.16-.017-.317-.044-.472.486-.261.82-.766.82-1.353zm-4.872.141c-.509 0-.922.412-.922.919 0 .506.414.918.922.918s.922-.412.922-.918c0-.507-.413-.919-.922-.919z" data-v-a564f786></path></svg></a><a href="https://t.me/KeepNetworkOfficial/" target="_blank" title="telegram" rel="noreferrer noopener" class="smallprint__item__links__item" data-v-a564f786><svg width="24" height="24" xmlns="http://www.w3.org/2000/svg" fill-rule="evenodd" clip-rule="evenodd" fill="#aaa" data-v-a564f786><path d="M12,0c-6.626,0 -12,5.372 -12,12c0,6.627 5.374,12 12,12c6.627,0 12,-5.373 12,-12c0,-6.628 -5.373,-12 -12,-12Zm3.224,17.871c0.188,0.133 0.43,0.166 0.646,0.085c0.215,-0.082 0.374,-0.267 0.422,-0.491c0.507,-2.382 1.737,-8.412 2.198,-10.578c0.035,-0.164 -0.023,-0.334 -0.151,-0.443c-0.129,-0.109 -0.307,-0.14 -0.465,-0.082c-2.446,0.906 -9.979,3.732 -13.058,4.871c-0.195,0.073 -0.322,0.26 -0.316,0.467c0.007,0.206 0.146,0.385 0.346,0.445c1.381,0.413 3.193,0.988 3.193,0.988c0,0 0.847,2.558 1.288,3.858c0.056,0.164 0.184,0.292 0.352,0.336c0.169,0.044 0.348,-0.002 0.474,-0.121c0.709,-0.669 1.805,-1.704 1.805,-1.704c0,0 2.084,1.527 3.266,2.369Zm-6.423,-5.062l0.98,3.231l0.218,-2.046c0,0 3.783,-3.413 5.941,-5.358c0.063,-0.057 0.071,-0.153 0.019,-0.22c-0.052,-0.067 -0.148,-0.083 -0.219,-0.037c-2.5,1.596 -6.939,4.43 -6.939,4.43Z" data-v-a564f786></path></svg></a></div></div><div class="smallprint" data-v-a564f786><div class="smallprint__item smallprint__item__links" data-v-a564f786><a href="https://keep.network/" data-v-a564f786>keep.network</a></div><div class="smallprint__item__desc smallprint__item" data-v-a564f786><div>© 2020</div></div></div></div></div></div></div></div></div></div><div class="sheet__sidebar" data-v-107b9df8 data-v-ef5e44d0><!----> <!----></div><div class="sheet__sidebar" data-v-107b9df8 data-v-ef5e44d0><!----> <!----></div><div class="sheet__sidebar sheet__sidebar__toc" data-v-107b9df8 data-v-ef5e44d0><!----> <!----></div></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.ee7cc7e2.js" defer></script><script src="/assets/js/21.10f9f555.js" defer></script><script src="/assets/js/18.6681fcd2.js" defer></script><script src="/assets/js/34.9f447bc8.js" defer></script><script src="/assets/js/22.3632abb5.js" defer></script><script src="/assets/js/42.134b01e7.js" defer></script><script src="/assets/js/52.7d2d0d58.js" defer></script><script src="/assets/js/26.14abd936.js" defer></script><script src="/assets/js/7.33575ab8.js" defer></script><script src="/assets/js/4.bcb8a545.js" defer></script><script src="/assets/js/74.ee77b48f.js" defer></script><script src="/assets/js/2.9632a545.js" defer></script><script src="/assets/js/24.5850abf4.js" defer></script><script src="/assets/js/10.3c97637c.js" defer></script><script src="/assets/js/9.1a5079a2.js" defer></script><script src="/assets/js/13.985b168b.js" defer></script><script src="/assets/js/17.539c5154.js" defer></script>
  </body>
</html>
